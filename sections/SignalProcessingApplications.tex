\section{Signal Processing Applications\buch{Chapter 8}}
\subsection{Digital Waveform Generators}
\subsubsection{Sinusodial Generators\buchSeite{316-320}}
\begin{align*}
	h(n) = R^n \sin(\omega_0 n)u(n) \qquad
	&& H(z) = \frac{R \sin \omega_0 z^{-1}}{1-2R\cos \omega_0 z^{-1} + R^2 z^{-2}}
\end{align*}

\subsubsection{Periodic Waveform Generators\buchSeite{31-329}}
In order for $x(n)$ to be periodic in the time index $n$ with some period, say of $D$ samples,
it is necessary that one whole period of the signal fit within the $D$ samples, that is,
at $n = D$ the signal must cycle by one whole period.

This requires that $x(D) = x(0)$, which requires
\begin{align*}
	\omega = \frac{2\pi}{D} && f = \frac{f_s}{D} && f_s = D && T_D = DT
\end{align*}


Because of the periodicity, it is enough to specify the signal over one period only:
\begin{align*}
	h = [b_0, b_1, \ldots, b_{D-1}, b_0, b_1, \ldots, b_{D-1}, b_0, \ldots]
\end{align*}

With the coresponding z-Transformation:
\begin{align*}
	H(z) = \frac{b_0 + b_1 z^{-1} + b_2 z^{-2} + \ldots + b_{D-1} z^{-(D-1)}}{1 - z^{-D}}
\end{align*}

\subsubsection{Wavetable Generators\buchSeite{330-349}}
Often, it is desired to generate a delayed version of the periodic waveform. Instead of
loading a delayed period into a new wavetable, we can use the same wavetable, but start
cycling over it at a shifted position. For a delay of m time units such that $0 \leq m \leq D-1$,
the starting pointer p and corresponding offset index q
\begin{flalign*}
p=w+m && q=m && y(n)=b(n-m) && y(0)=b(-m)=b(D-m)
\end{flalign*}
\begin{flalign*}
m=0 && [b_0,b_1,b_2,b_3,b_0,b_1,b_2,b_3,b_0,b_1,b_2,b_3,\ldots]&&&&\\
m=1 && [b_3,b_0,b_1,b_2,b_3,b_0,b_1,b_2,b_3,b_0,b_1,b_2,\ldots]&&&&\\
m=2 && [b_2,b_3,b_0,b_1,b_2,b_3,b_0,b_1,b_2,b_3,b_0,b_1,\ldots]&&&&\\
m=3 && [b_1,b_2,b_3,b_0,b_1,b_2,b_3,b_0,b_1,b_2,b_3,b_0,\ldots]&&&&
\end{flalign*}
wavetable of length D, fundamental frequency is by
\begin{flalign*}
& f=\frac{f_s}{D}&&
\end{flalign*}

\begin{flalign*}
& c &&\text{real-valued shift} && D && \text{dimension of the circular buffer} && d &&\text{number of times the sub-period}\\
& c=\frac{D}{d}&& f=\frac{f_s}{d}=c\frac{f_s}{D}
\end{flalign*}
to keep f within the symmetric Nyquist interval 
\begin{flalign*}
|f|\leq \frac{f_s}{2} && |\frac{cf_s}{D}|\leq \frac{f_s}{2} && |c|\leq \frac{D}{2} && -\frac{D}{2}\leq c\leq\frac{D}{2}
\end{flalign*}
the circular wavetable
is loaded with the waveform in forward order. Cycling over the wavetable at frequency
$f = cfs/D$ is accomplished by incrementing the offset index q according to the iteration:
\begin{align*}
& q_{n+1}=(q_n-c)\%(D)&& &&\\
& i=\lfloor q\rfloor && \text{truncating down} && y=w[i]&&\\
& j=\lfloor q+1\rfloor \%(D) && \text{truncating up} && y=w[j]&&\\
& k=\lfloor q+0.5\rfloor \%(D) && \text{rounding} && y=w[k]&&
\end{align*}
a more accurate output can
be obtained by linearly interpolating between the wavetable values w[i] and w[j], that
is, returning the output:
\begin{align*}
y=w[i]+(q-i)(w[j]-w[i])
\end{align*}
\subsection{Digital Audio Effects\buchSeite{349-373}}
\begin{tabularx}{\textwidth}{|l|l|l|X|}
\hline 
\textbf{Filter} & \textbf{Signal} $y(n) = $ & 
\textbf{Transfer function} & \textbf{Impulse response} $ h(n) = $
\\ \hline
echo filter & $x(n) + ax(n-D)$ &
$H(z) = 1 + az^{-D}$ & $\delta(n) + a \delta(n-D)$
\\ \hline
plain reverberator & $a y(n-D) + x(n)$ &
$H(z) = \frac{1}{1-a z^{-D}}$ & $\delta(n) + a \delta(n-D) + a^2 \delta(n- 2D) + \ldots$
\\ \hline
allpass reverberator & $a y(n-D) -ax(n) + x(n-D)$ & $H(z) = \frac{-a + z^{-D}}{1-az^{-D}} $ &
\\ \hline
flanging processor & $x(n) + a x(n- d(n))$ & &
\\ \hline
\end{tabularx}


\subsubsection{Multitab Delays\buchSeite{374}}
Simple low-order FIR or IIR filters by replacing each single unit-delay $z^{-1}$ by the progressively more general substitutions:
\begin{flalign*}
& z^{-1} && \longrightarrow && z^{-D}&\longrightarrow && \frac{z^{-D}}{1-az^{-D}}&& \longrightarrow && \frac{z^{-D}}{1-z^{-D}G(z)} &
\end{flalign*}
\begin{flalign*}
&\frac{z^{-D}}{1-az^{-D}} && \text{Expanding in powers of }z^{-D} \text{ we have} && H(z)= z^{-D} + az^{-2D}+a^2 z^{-3D} \dots&&
\end{flalign*}
The corresponding impulse response will consist of the first delayed impulse $\delta(n-
D)$, followed by its successive echoes of exponentially diminishing strength:
\begin{align*}
h(n)=\delta(n-D)+a\delta(n-2D)+a^2\delta(n-3D)+\ldots
\end{align*}

\subsubsection{Compressors, Limiters, Expanders, and Gates\buchSeite{378-380}}
Expanders are used for increasing the dynamic range of signals, for noise reduction,
and for various special effects
\begin{flalign*}
& y=y_0\left(\frac{x}{x_0}\right)^{\rho} && \Rightarrow && 20log_{10}\left(\frac{y}{y_0}\right)=\rho20log_{10}\left(\frac{x}{x_0}\right)&&
\end{flalign*}
\begin{flalign*}
& x: && \text{constant input} && x_0: \text{desire threshold} && \rho: && \text{compression or expansion ratio}\\
\end{flalign*}
\begin{flalign*}
&\text{compressor:} && x\geq x_0 && \text{and}&& \rho < 1&&\\
&\text{expander} && x\leq x_0 && \text{and}&& \rho > 1&& 
\end{flalign*}

\subsection{Noise Reduction and Signal Enhancement}

\subsubsection{Noise Reduction Filters\buchSeite{382-385}}
\begin{flalign*}
&\text{Noise measured Signal}&& x(n)=s(n)+\nu(n)&&&&\\
&\text{Desired signal}&& s(n)&&&&\\ 
&\text{Noise}&& \nu(n)&&&&\\
& \text{Noise reduction ratio \tiny{Small NNR means large noise reduction}} && 
NRR=\frac{\sigma_{y_{\nu}}^2}{\sigma_{\nu}^2}
=\int\limits_{-\pi}^{\pi}|H(\omega)|^2 \frac{d\omega}{2\pi} =\sum_n h_n^2 &&&&\\
& \text{Ideal Lowpass filter} && NRR=\frac{\sigma_{y_{\nu}}^2}{\sigma_{\nu}^2}
=\int\limits_{-\omega_c}^{\omega_c}1\frac{\omega}{2\pi}=\frac{2\omega_c}{2\pi}=\frac{\omega_c}{\pi} &&&&\\
& \text{The same hold for an ideal bandpass filter} && NRR=\frac{\omega_b-\omega_a}{\pi}&&&&\\
&\text{Input mean-square noise}&&\sigma_{\nu}^2 &&&&\\
&\text{Output mean-square noise}&& \sigma_{y_{\nu}}^2 &&&&\\
& \text{SNR and NRR ratio}&& \frac{SNR_{out}}{SNR_{in}}=\frac{1}{NRR} \cdot \frac{E[y_s(n)^2]}{E[s(n)^2]}&&&&\\
& \text{If signal is not distorted } (y_s=s)&& \frac{SNR_{out}}{SNR_{in}}=\frac{1}{NRR} &&&&
\end{flalign*}

\subsubsection{Notch and Comb Filters\buchSeite{398-406}}
Two special cases of the signal enhancement/noise reduction problem arise when:
\begin{enumerate}

\item The noise signal v(n) in Eq. (8.3.1) is periodic. Its spectrum is concentrated at
the harmonics of a fundamental frequency. The noise reduction filter is an ideal
notch filter with notches at these harmonics \item The desired signal s(n) is periodic and the noise is a wideband signal. Now, the
signal enhancement filter is an ideal comb filter with peaks at the harmonics of
the desired signal
\end{enumerate} 

The ideal notch and comb filters are complementary filters,
in the sense that one is zero where the other is one, so that their frequency responses
add up to unity:

normalized to unity half-way between the notches:
\begin{flalign*}
& H_{notch}(z)=\frac{bN(z)}{N(\rho z)}=b \frac{1-z^{-D}}{1-az^{-D}}&& b=\frac{1+a}{2}&& a=\rho^D &&
\omega_k = \frac{(2k + 1)\pi}{D} &&\\
&&&&&&&\\
& \text{paramter a on the desired 3-dB width:}&& \Delta\omega=\frac{2\pi\Delta f}{f_s}&&\text{on the notch dips}  &&\\
&&&&&&&\\
& &&\beta=\tan \frac{D\Delta\omega}{4} && a=\frac{1-\beta}{1+\beta} && b=\frac{1}{1+\beta}&&\\
& \text{restriction and maximum value}&& 0<\beta<1 && \Delta\omega\leqslant\frac{\pi}{D}&& \Delta\leqslant\frac{f_s}{2D}&&\\
&\text{squared magnitude response}&&\left|H_{notch}(\omega)\right|^2&&=\frac{\tan^2(\omega D /2)}{\tan^2(\omega D/2)+\beta^2}&&
\end{flalign*}


\emph{narrow lowpass filter:}
\begin{flalign*}
& \text{normalized} && H_{comb}(z)=b \frac{1+z^{-D}}{1-az^{-D}}&& b=\frac{1-a}{2}&& a=\rho^D &&&&\\
&\text{peaks at} && \omega_k = \frac{2k\pi}{D} && \text{zeros at}&&
\omega_k = \frac{(2k + 1)\pi}{D} &&\\
&&&&&&&\\
& \text{paramter a on the desired 3-dB width:}&& \Delta\omega=\frac{2\pi\Delta f}{f_s}&&  &&\\
&&&&&&&\\
& &&\beta=\tan \frac{D\Delta\omega}{4} && a=\frac{1-\beta}{1+\beta} && b=\frac{\beta}{1+\beta}&&\\
&\text{squared magnitude response}&&\left|H_{comb}(\omega)\right|^2&&=\frac{\beta^2}{\tan^2(\omega D/2)+\beta^2}&&
\end{flalign*}
\begin{flalign*}
& H_{notch}(\omega)+H_{comb}(\omega)=\frac{1-a}{2}\frac{1+z^{-D}}{1-az^{-D}}+\frac{1+a}{2}\frac{1-z^{-D}}{1-az^{-D}}=1&&
\end{flalign*}


\subsubsection{Line and Frame Combs for Digital TV\buchSeite{409-421}}
\begin{flalign*}
& T_H && \text{line delay} &&&& f_H && \text{horizontal velocities} \\
& T_F && \text{frame delays} &&&& f_F && \text{vertical velocities} \\
& T_F=NT_H &&&&&& N && \text{N lines}\\
& f_H=Nf_F&& f_=\frac{1}{t_H}&& f_F=\frac{1}{T_F}&& f_H=\frac{\nu_x}{a} && f_F=\frac{\nu_y}{b}&&
\end{flalign*}

The video signal $V(t)$ will have spectrum with sharp spectral lines at $f_{km}$

\begin{align*}
f_{km}=kf_H+mf_f=(kN+m)f_F=(k+\frac{m}{N})f_H
\end{align*}

By choosing the subcarrier frequency $f_{sc}$ to be a half-multiple of the line frequency $f_H$, the chrominance peaks will fall exactly half-way between the luminance peaks.

\begin{flalign*}
&&& f_{sc}=(d_H+\frac{1}{2})f_H=\frac{1}{2}(2d_H+1)f_H &&&& \\
&&& f_{sc}=(d_F+\frac{1}{2})f_F=\frac{1}{2}(2d_F+1)f_F &&&& \\
&\text{by NTSC system} && d_H=227 && d_F=Nd_H + \frac{N-1}{2}=119437&&
\end{flalign*}
A common samplling rate for digital video systems is four times the color subcarrier frequency:
\begin{flalign*}
& f_s=4f_{sc} && f_s=D_Hf_H=D_Ff_F && \omega_{sc}=\frac{2\pi f_{sc}}{f_s}=\frac{\pi}{2}&&&&&&
\end{flalign*}

\subsubsection{Signal Averaging\buchSeite{421-425}}
The transfer function can be derived by taking a length N FIR averaging filter and applying the replication transform $z \rightarrow z^D$
\begin{flalign*}
& H(z)=\frac{1}{N}\left( 1+ z^{-D}+z^{-2D}+\ldots + z^{-(N-1)D} \right)=\frac{1}{N}\frac{z^{-ND}}{1-z^{-D}}&&
\end{flalign*}
In the time domain, the signal averaging comb filter is given by the following I/O difference equation
\begin{flalign*}
& y(n)=\frac{1}{N}\left[x(n)+x(n-D)+x(n-2D)+\ldots+x(n-(N-1)D)\right] &&
\end{flalign*}
In general, that is there are N periods
\begin{flalign*}
& \hat{y}(n)=\frac{1}{N}\sum_{i=0}^{N-1}x_i(n) && \hat{y}(n)=\frac{1}{N}\sum_{i=0}^{N-1}(s(n)+\nu_i(n))=s(n)+ \frac{1}{N}\sum_{i=0}^{N-1}\nu_i(n)=s(n)+\hat{\nu}(n)&&\\
&\sigma_{\hat{\nu}}^2=\frac{1}{N^2}(\sigma_{\nu}^2+\sigma_{\nu}^2+\ldots+\sigma_{\nu}^2)=\frac{1}{N^2}(N\sigma_{\nu}^2)=\frac{1}{N}\sigma_{\nu}^2 &&&&
\end{flalign*}

\subsubsection{Savitzky-Golay Smoothing Filters\buchSeite{427-451}}

Lin-Alg matrices see book
