\section{Signal Processing Applications\buch{Chapter 8}}
\subsection{Digital Waveform Generators}
\subsubsection{Sinusodial Generators}
\[
	h(n) = R^n \sin(\omega_0 n)u(n) \qquad
	H(z) = \frac{R \sin \omega_0 z^{-1}}{1-2R\cos \omega_0 z^{-1} + R^2 z^{-2}}
\]

\subsubsection{Periodic Waveform Generators}
In order for $x(n)$ to be periodic in the time index $n$ with some period, say of $D$ samples,
it is necessary that one whole period of the signal fit within the $D$ samples, that is,
at $n = D$ the signal must cycle by one whole period.

This requires that $x(D) = x(0)$, which requires
\[
	\omega = \frac{2\pi}{D} \qquad f = \frac{f_s}{D} \qquad f_s = D \qquad T_D = DT
\]

Because of the periodicity, it is enough to specifiy the signal over one period only:
\[
	h = [b_0, b_1, \ldots, b_{D-1}, b_0, b_1, \ldots, b_{D-1}, b_0, \ldots]
\]

With the corespondig z-Transformation:
\[
	H(z) = \frac{b_0 + b_1 z^{-1} + b_2 z^{-2} + \ldots + b_{D-1} z^{-(D-1)}}{1 - z^{-D}}
\]

\subsubsection{Wavetable Generators}

\subsection{Digital Audio Effects}
\begin{tabular}{|l|l|l|l|}
\hline 
\textbf{Filter} & \textbf{Signal} $y(n) = $ & 
\textbf{Transfer function} & \textbf{Impulse response} $ h(n) = $
\\ \hline
echo filter & $x(n) + ax(n-D)$ &
$H(z) = 1 + az^{-D}$ & $\delta(n) + a \delta(n-D)$
\\ \hline
plain reverberator & $a y(n-D) + x(n)$ &
$H(z) = \frac{1}{1-a z^{-D}}$ & $\delta(n) + a \delta(n-D) + a^2 \delta(n- 2D) + \ldots$
\\ \hline
allpass reverberator & $a y(n-D) -ax(n) + x(n-D)$ & $H(z) = \frac{-a + z^{-D}}{1-az^{-D}} $ &
\\ \hline
flanging processor & $x(n) + a x(n- d(n))$ & &
\\ \hline
\end{tabular}


\subsubsection{Multitab Delays}
\subsubsection{Compressors, Limiters, Expanders, and Gates}

\subsection{Noise Reduction and Signal Enhancement}

\subsubsection{Noise Reduction Filters\buchSeite{382-385}}
\begin{flalign}
&\text{noise measured Signal}&& x(n)=s(n)+\nu(n)&&&&\notag\\
&\text{desired signal}&& s(n)&&&&\notag\\ 
&\text{noise}&& \nu(n)&&&&\notag\\
& \text{noise reduction ration} && 
NRR=\frac{\sigma_{y_{\nu}}^2}{\sigma_{\nu}^2}
=\int\limits_{-\pi}^{\pi}|H(\omega)|^2 \frac{d\omega}{2\pi} =\sum_n h_n^2 &&&&\notag\\
& \text{Ideal Lowpass filter} && NRR=\frac{\sigma_{y_{\nu}}^2}{\sigma_{\nu}^2}
=\int\limits_{-\omega_c}^{\omega_c}1\frac{\omega}{2\pi}=\frac{2\omega_c}{2\pi}=\frac{\omega_c}{\pi} &&&&\notag\\
&\text{input mean-square noise}&&\sigma_{\nu}^2 &&&&\notag\\
&\text{output mean-square noise}&& \sigma_{y_{\nu}}^2 &&&&\notag\\
& \text{SNR and NRR ratio}&& \frac{SNR_{out}}{SNR_{in}}=\frac{1}{NRR}&&&&\notag
\end{flalign}

\subsubsection{Notch and Comb Filters\buchSeite{398-406}}
Two special cases of the signal enhancement/noise reduction problem arise when:
\begin{enumerate}

\item The noise signal v(n) in Eq. (8.3.1) is periodic. Its spectrum is concentrated at
the harmonics of a fundamental frequency. The noise reduction filter is an ideal
notch filter with notches at these harmonics \item The desired signal s(n) is periodic and the noise is a wideband signal. Now, the
signal enhancement filter is an ideal comb filter with peaks at the harmonics of
the desired signal
\end{enumerate} 

The ideal notch and comb filters are complementary filters,
in the sense that one is zero where the other is one, so that their frequency responses
add up to unity:

normalized to unity half-way between the notches:
\begin{flalign}
& H_{notch}(z)=\frac{bN(z)}{N(\rho z)}=b \frac{1-z^{-D}}{1-az{-D}}&& b=\frac{1+a}{2}&& a=\rho^D &&
\omega k = \frac{(2k + 1)\pi}{D} &&\notag\\
&&&&&&&\notag\\
& \text{paramter a on the desired 3-dB width:}&& \Delta\omega=\frac{2\pi\Delta f}{f_s}&&\text{on the notch dips}  &&\notag\\
&&&&&&&\notag\\
& &&\beta=\tan \frac{D\Delta\omega}{4} && a=\frac{1-\beta}{1+\beta} && b=\frac{1}{1+\beta}&&\notag\\
& \text{restriction and maximum value}&& 0<\beta<1 && \Delta\omega\leqslant\frac{\pi}{D}&& \Delta\leqslant\frac{f_s}{2D}&&\notag\\
&\text{squared magnitude response}&&\left|H_{notch}(\omega)\right|^2&&=\frac{\tan^2(\omega D /2)}{\tan^2(\omega D/2)+\beta^2}&&\notag
\end{flalign}


\emph{narrow lowpass filter:}
\begin{flalign}
& \text{normalized} && H_{comp}(z)=b \frac{1+z^{-D}}{1-az{-D}}&& b=\frac{1-a}{2}&& a=\rho^D &&&&\notag\\
&\text{peaks at} && \omega k = \frac{2k\pi}{D} && \text{zeros at}&&
\omega k = \frac{(2k + 1)\pi}{D} &&\notag\\
&&&&&&&\notag\\
& \text{paramter a on the desired 3-dB width:}&& \Delta\omega=\frac{2\pi\Delta f}{f_s}&&  &&\notag\\
&&&&&&&\notag\\
& &&\beta=\tan \frac{D\Delta\omega}{4} && a=\frac{1-\beta}{1+\beta} && b=\frac{\beta}{1+\beta}&&\notag\\
&\text{squared magnitude response}&&\left|H_{comb}(\omega)\right|^2&&=\frac{\beta^2}{\tan^2(\omega D/2)+\beta^2}&&\notag
\end{flalign}
\begin{flalign}
& H_{notch}(\omega)+H_{comb}(\omega)=\frac{1-a}{2}\frac{1+z^{-D}}{1-az^{-D}}+\frac{1+a}{2}\frac{1-z^{-D}}{1-az^{-D}}=1&&\notag
\end{flalign}




\subsubsection{Signal Averaging\buchSeite{421-425}}
The transfer function can be derived by taking a length N FIR averaging filter and applying the replication transform $z \rightarrow z^D$
\begin{flalign}
& H(z)=\frac{1}{N}\left( 1+ z{-D}+z{-2D}+\ldots + z{-(N-1)D} \right)=\frac{1}{N}\frac{z{-ND}}{1-z{-D}}&&\notag
\end{flalign}
In the time domain, the signal averaging comb filter is given by the following I/O difference equation
\begin{flalign}
& y(n)=\frac{1}{N}\left[x(n)+x(n-D)+x(n-2D)+\ldots+x(n-(N-1)D)\right] &&\notag
\end{flalign}
In general, that is there are N periods
\begin{flalign}
& \hat{y}(n)=\frac{1}{N}\sum_{i=0}^{N-1}x_i(n) && \hat{y}(n)=\frac{1}{N}\sum_{i=0}^{N-1}(s(n)+\nu_i(n))=s(n)+ \frac{1}{N}\sum_{i=0}^{N-1}\nu_i(n)=s(n)+\hat{\nu}(n)&&\notag\\
&\sigma_{\hat{\nu}}^2=\frac{1}{N^2}(\sigma_{\nu}^2+\sigma_{\nu}^2+\ldots+\sigma_{\nu}^2)=\frac{1}{N^2}(N\sigma_{\nu}^2)=\frac{1}{N}\sigma_{\nu}^2 &&&&\notag
\end{flalign}

\subsubsection{Savitzky-Golay Smoothing Filters\buchSeite{427-451}}

Lin-Alg matrices see book
