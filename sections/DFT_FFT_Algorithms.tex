\section{DFT/FFT Algorithms\buch{Chapter 9}}
\subsection{Begriffe}

\begin{tabularx}{\textwidth}{l p{3cm}XX}
	Abkürzung & Name  & Eigenschaft & Anwendung \\\hline
	DTFT &
	discrete-time Fourier transform &
	bildet ein endliches, zeitdiskretes Signal auf ein kontinuierliches, periodisches Frequenzspektrum ab &
	Im Spektrum lässt sich unter Umständen  abschnittsweise ein geschlossener mathematischer Ausdruck angeben \\
	DFT &
	discrete Fourier transform &
	bildet ein zeitdiskretes, endliches Signal, welches periodisch fortgesetzt wird, auf ein diskretes, periodisches Frequenzspektrum ab &
	DFT besitzt zur Signalanalyse große Bedeutung \\
	FFT &
	fast Fourier transform &
	ein Algorithmus zur effizienten Berechnung der Werte einer diskreten Fourier-Transformation (DFT) &
	\vspace{-19pt}
	\begin{itemize}
		\item Zur Reduzierung des Berechnungsaufwandes bei der zirkularen Faltung
		\item im Zeitbereich von FIR-Filtern
		\item Ersatz durch die schnelle Fouriertransformation und einfache Multiplikationen im Frequenzbereich
		\item Synthese von Audiosignalen aus einzelnen Frequenzen über die inverse FFT
	\end{itemize}\\
\end{tabularx}

\subsection{Frequency Resolution and Windowing\buchSeite{464-472}}
\begin{tabular}{|l|l|l|}
	\hline
	symbol & property & formulas
	\\ \hline
	$T_L$ & duration of data record & $ = LT$
	\\ \hline
	$w(n)$ & Window function &
	\\ \hline
	$\Delta \omega_w$ & Window width (rad/sample) & $ = c \frac{2 \pi}{L}$
	\\ \hline
	$\Delta f_w$ & Window width (Hz) & $ = c \frac{f_s}{L} = c \frac{1}{T_L} $
	\\ \hline
	$\Delta f$ & Frequency resolution & $ \Delta f \geq \Delta f_w=c\frac{f_s}{L}=c\frac{1}{T_L}$
	\\ \hline
	$\Delta\omega$ & Resolvability condition & $=\Delta\omega \geq \Delta\omega_w = c\frac{2\pi}{L}$ 
	\\\hline
	$R$ & relative sidelobe level &
	\\ \hline
	$c$ & depends on window, always $\geq 1$ &
	\\ \hline
	$L$ & Windows länge &
	\\ \hline
	$N$ & N-Point DFT, DFT länge &
	\\ \hline
\end{tabular}


\begin{flalign*}
& \text{Window/Funktion} && \text{Rectangular} && \text{Hamming}\\
& w(n) &&  \begin{cases}
			1, & \text{if } 0 \leq n \leq L-1 \\
			0, & \text{otherwise}
 \end{cases} &&
\begin{cases}
	0.54 - 0.46 \cos(\frac{2\pi n}{L-1}), & \text{if } 0 \leq n \leq L-1 \\
	0, & \text{otherwise}
\end{cases} \\
& \text{window tradeoff } c && c=1 && c=2\\
& R && -13.46 dB && -40 dB\\
& x_{_L}(n) && x(n)w(n) && \\
& X_{_L}(\omega) && \int_{-\pi}^{\pi}X(\omega')W(\omega-\omega')\frac{d\omega'}{2\pi} && \\
\end{flalign*}



\subsection{DTFT Computation}
\subsubsection{DTFT at a Single Frequency\buchSeite{475-477}}
\begin{align*}
X(\omega)=\sum_{n=0}^{L-1}x(n)e^{-j\omega n}=\sum_{n=0}^{L-1}x(n)z^{-n}\biggr|_{z=e^{j\omega}}=X(z)\biggr|_{z=e^{j\omega}}
\end{align*}

For example let L = 4
\begin{flalign*}
& X && = && x_3+z^{-1}X && = && x_3\\
& X && = && x_2+z^{-1}X && = && x_2+z^{-1}x_3\\
& X && = && x_1+z^{-1}X && = && x_1+z^{-1}x_2+z^{-2}x_3\\
& X && = &&  x_0+z^{-1}X && = && x_0+z^{-1}x_1+z^{-2}x_2+z^{-3}x_3 && = && X(z)&&\\
\end{flalign*}

\subsubsection{DTFT over a Frequency Range\buchSeite{478}}
\begin{flalign*}
& \omega_k=\frac{2\pi k}{N}&& f_k=\frac{kf_s}{N} && z_k=e^{j\omega_k}=e^{2\pi jk/N} && k=0,1,\ldots , N-1 
\end{flalign*}
\begin{flalign*}
& X(\omega_k)=\sum_{n=0}^{L-1}x(n)e^{-j\omega_kn} = \sum_{n=0}^{L-1}x(n)z_k^{-n} && && 
\end{flalign*}
\begin{flalign*}
&\omega_k=\omega_a+k\frac{\omega_b-\omega_a}{N}=\omega_a+k\Delta\omega_{bin} && \omega_{bin}=\frac{\omega_b-\omega_a}{N} && \text{or in Hz} && \Delta f_{bin}=\frac{f_b-f_a}{N} && \omega_{k+N}=\omega_k+2\pi
\end{flalign*}

\subsubsection{DFT\buchSeite{479-481}}
\begin{flalign*}
&\omega_k=\frac{2\pi k}{N}&& f_k=\frac{kf_s}{N} && z_k=e^{j\omega_k}=e^{2\pi jk/N} && k=0,1,\ldots , N-1 
\end{flalign*}
\begin{flalign*}
& X(\omega_k)=\sum_{n=0}^{L-1}x(n)e^{-j\omega_kn} = \sum_{n=0}^{L-1}x(n)z_k^{-n} && &&
\end{flalign*}
\begin{flalign*}
&\Delta\omega_{bin}=\frac{2\pi}{N} && \text{or} && \Delta f_{bin}=\frac{f_s}{N} && \omega_{k+N}=\omega_k+2\pi
\end{flalign*}
\subsubsection{Zero Padding\buchSeite{482}}
Alle an das Signal angehängten '0' ändern die DTFT nicht 
\begin{align*}
x= [x_0,x_1,\ldots,x_{L-1}] && x_D=[x_0,x_1,\ldots,x_{L-1},\underbrace{0,0,\ldots,0}_{D zeros}] && X_D(\omega_k)=X(\omega_k)\\
\end{align*}

Alle vor das Signal angehängten '0' verschieben das Original Signal zurück
\begin{align*}
x= [x_0,x_1,\ldots,x_{L-1}] && x_D=[\underbrace{0,0,\ldots,0}_{D zeros},x_0,x_1,\ldots,x_{L-1}] \\
X_D(\omega)=e^{-j\omega D}X(\omega) && X_D(\omega_k)=e^{-j\omega_k D}X(\omega_k) && k=0,1,\ldots,N-1
\end{align*}

\subsection{Physical versus Computional Resolution\buchSeite{482-485}}
Eine künstliche Frequenzauflösung mittels Vergrösserung des N kann keine peaks die mit zu kleinem L verpasst wurden wieder rekonstruieren. 

\begin{align*}
f_0 = f_{k_0}=\frac{k_0f_s}{N} && k_0=N\frac{f_0}{k_s} && k=N\frac{f}{f_s} && 0 \leq f \leq f_s && 0 \leq k \leq N
\end{align*}

\subsection{Matrix Form of DFT\buchSeite{486-488}}
\begin{align*}
X=DFT(x)=Ax && X_k=\sum_{n=0}^{L-1}A_{kn}x_n && k=0,1,\ldots,N-1
\end{align*}
\begin{flalign*}
& \text{2-point} && W_2=e^{-2\pi j/2}=-1 &&
 A=
\begin{bmatrix}
1 & 1  \\
1 & W_2 
\end{bmatrix}
=
\begin{bmatrix}
1 & 1  \\
1 & -1 
\end{bmatrix}\\
& \text{4-point}&& W_4=e^{-2\pi j/4}=-j &&
A=
\begin{bmatrix}
1 & 1 & 1 & 1  \\
1 & W_4 & W_4^2 & W_4^3 \\
1 & W_4^2 & W_4^4 & W_4^6 \\
1 & W_4^3 & W_4^6 & W_4^9
\end{bmatrix}
=
\begin{bmatrix}
1 & 1 & 1 & 1  \\
1 & -j & -1 & j  \\
1 & -1 & 1 & -1 \\
1 & j & -1 & -j
\end{bmatrix}\\
&\text{8-point} && W_8=e^{-2\pi j/8}=\frac{1-j}{\sqrt{2}} &&
A=\begin{bmatrix}
 \ldots\\
 \ddots\\
 \ldots
 \end{bmatrix}
\end{flalign*}

\subsection{Module-N reduction\buchSeite{489-496}}
\begin{itemize}
	\item Opposite of zero padding
\end{itemize}
\begin{flalign*}
&\tilde{x}=x_0+x_1+\ldots+x_n &&
\end{flalign*}
\begin{flalign*}
& X=Ax=[\tilde{A},\tilde{A},\ldots,\tilde{A}]\begin{bmatrix}
x_0\\x_1\\ \vdots\\ x_n
\end{bmatrix}=\tilde{A}(x_0+x_1+\ldots + x_n)=\tilde{A}\tilde{x}=\tilde{X} &&
\end{flalign*}
\begin{flalign*}
& x=[\underbrace{a_1,a_2,a_3}_{x_0},\underbrace{a_4,a_5,a_6}_{x_1},\underbrace{a_7,a_8,a_9}_{x_2},\underbrace{a_{10},a_{11} , \text{fehlende Stelle} }_{x_3}]&&\\
& \tilde{x}=x_0^T+x_1^T+x_2^T+x_3^T=
\begin{bmatrix}a_1\\a_2\\a_3\end{bmatrix}+\begin{bmatrix}a_4\\a_5\\a_6\end{bmatrix}+\begin{bmatrix}a_7\\a_8\\a_9\end{bmatrix}+\begin{bmatrix}a_{10}\\a_{11}\\0\end{bmatrix}&&\\ 
& \text{fehlende Stelle mit '0' auffüllen}&&
\end{flalign*}

\subsection{Inverse DFT\buchSeite{496-499}}
\begin{flalign*}
&\tilde{x}=IDFT(X)=\tilde{A}^{-1} X && \tilde{x}=IDFT(X)=\frac{1}{N}\tilde{A}^{*} X && IDFT(X) = \frac{1}{N}\left[DFT(X^*)\right]^* \label{eq:IDFT}\\
&\tilde{x}=x && \text{nur wenn} && N \geq L\notag\\
&\tilde{x}\neq x && \text{wenn} && N < L\notag
\end{flalign*}

\subsection{Sampling of Periodic Signals and the DFT\buchSeite{499-501}}
\begin{flalign*}
& x(n)=\frac{1}{N}\sum_{k=0}^{N-1}X(\omega_k)e^{j\omega_k n} && \text{(DFS)} &&\\
& X(\omega_k)=\sum_{k=0}^{N-1}x(n)e^{-j\omega_k n} && \text{(DFS coefficients)}&&
\end{flalign*}
\subsection{FFT\buchSeite{504-511}}
Decimation-in-time radix-2 FFT
\begin{flalign*}
&\text{Radix 2 means} && N=2^B&&
\end{flalign*}
\begin{flalign*}
& X(k)=G(k)+W_N^kH(k) && X(k+N/2)=G(k)-W_N^kH(k) && k=0,1,\ldots,\frac{N}{2}-1 &&\\
& G(k)=\sum_{n=0}^{\frac{N}{2}-1}W_{\frac{N}{2}}^{kn}g(n) &&  H(k)=\sum_{n=0}^{\frac{N}{2}-1}W_{\frac{N}{2}}^{kn}h(n) && g(n)=x(2n)&& h(n)=x(2n+1)
\end{flalign*}
\begin{align*}
\begin{bmatrix}
X_0\\X_1\\ \vdots\\ X_{\frac{N}{2}-1}
\end{bmatrix}
=
\begin{bmatrix}
G_0\\G_1\\ \vdots\\ G_{\frac{N}{2}-1}
\end{bmatrix}
+
\begin{bmatrix}
H_0\\H_1\\ \vdots\\ H_{\frac{N}{2}-1}
\end{bmatrix}
\times
\begin{bmatrix}
W_N^0\\W_N^1\\ \vdots\\ X_N^{\frac{N}{2}-1}
\end{bmatrix}
\end{align*}
% Todo Tikz
\subsection{Fast Convolution}
\subsubsection{Circular Convolution\buchSeite{516-518}}
\begin{flalign*}
& \text{Grundlage:}&& y=h\ast x && \Leftrightarrow && Y(\omega)=H(\omega)X(\omega)&&
\end{flalign*}
\begin{flalign*}
& \text{mittels DTFT:} && y=IDTFT(DTFT(h)DTFT(x))&&\\
& \text{mittels DFT:} && \tilde{y}=\widetilde{h\ast x}=IDFT(DFT(h)DFT(x))&&\\
&\text{Modulo-N-reduzierte Ergebnisse}&& \tilde{y}=\widetilde{h\ast x}= \widetilde{ {\widetilde{h}} \ast  x}=\widetilde{h\ast \tilde{x}}=\widetilde{\tilde{h}\ast \tilde{x}}&&\\ 
% ToDo irgend ein problem mit der widetilde, geht auch mit anderen buchstaben die nicht hoch sind nicht z.b. a
& \text{Bedingung, zirkuläre Faltung = Lineare Faltung} && \tilde{y}=y \text{ wenn } N\geq L_y=L+M&&
\end{flalign*}
\subsubsection{Overlap-Add and Overlap-Save Methods\buchSeite{520-522}}


